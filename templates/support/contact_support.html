{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}Contact Support - TBL SACCOS{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1 class="h2 mb-2">
                    <i class="fas fa-headset text-primary me-2"></i>Contact Support
                </h1>
                <p class="text-muted mb-0">Get help with your loan or account</p>
            </div>
            <a href="{% url 'dashboard:index' %}" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
            </a>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-envelope me-2"></i>Send Message</h5>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.subject.id_for_label }}" class="form-label">
                                    <i class="fas fa-heading me-1"></i>Subject *
                                </label>
                                {{ form.subject }}
                                {% if form.subject.errors %}
                                    <div class="text-danger small mt-1">{{ form.subject.errors.0 }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.category.id_for_label }}" class="form-label">
                                    <i class="fas fa-tag me-1"></i>Category *
                                </label>
                                {{ form.category }}
                                {% if form.category.errors %}
                                    <div class="text-danger small mt-1">{{ form.category.errors.0 }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.priority.id_for_label }}" class="form-label">
                                    <i class="fas fa-exclamation-triangle me-1"></i>Priority
                                </label>
                                {{ form.priority }}
                                {% if form.priority.errors %}
                                    <div class="text-danger small mt-1">{{ form.priority.errors.0 }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.related_loan.id_for_label }}" class="form-label">
                                    <i class="fas fa-handshake me-1"></i>Related Loan
                                </label>
                                {{ form.related_loan }}
                                {% if form.related_loan.errors %}
                                    <div class="text-danger small mt-1">{{ form.related_loan.errors.0 }}</div>
                                {% endif %}
                                <div class="form-text text-muted">Select if this is about a specific loan</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="{{ form.message.id_for_label }}" class="form-label">
                            <i class="fas fa-align-left me-1"></i>Message *
                        </label>
                        {{ form.message }}
                        {% if form.message.errors %}
                            <div class="text-danger small mt-1">{{ form.message.errors.0 }}</div>
                        {% endif %}
                        <div class="form-text text-muted">Describe your issue or question in detail</div>
                    </div>

                    <div class="mb-4">
                        <label for="{{ form.attachment.id_for_label }}" class="form-label">
                            <i class="fas fa-paperclip me-1"></i>Attachment (Optional)
                        </label>
                        {{ form.attachment }}
                        {% if form.attachment.errors %}
                            <div class="text-danger small mt-1">{{ form.attachment.errors.0 }}</div>
                        {% endif %}
                        <div class="form-text text-muted">Upload screenshots, documents, or other relevant files</div>
                    </div>

                    <hr class="my-4">

                    <div class="d-flex justify-content-between align-items-center">
                        <div class="text-muted small">
                            <i class="fas fa-info-circle me-1"></i>
                            Fields marked with * are required
                        </div>
                        <div>
                            <button type="reset" class="btn btn-outline-secondary me-2">
                                <i class="fas fa-eraser me-1"></i>Reset
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane me-1"></i>Send Message
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Support Information</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <h6 class="text-primary mb-2">Contact Methods</h6>
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-phone text-primary me-2"></i>
                        <span>+255 123 456 789</span>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-envelope text-primary me-2"></i>
                        <span>support@tblsaccos.co.tz</span>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-map-marker-alt text-primary me-2"></i>
                        <span>Dar es Salaam, Tanzania</span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6 class="text-primary mb-2">Business Hours</h6>
                    <div class="d-flex justify-content-between mb-1">
                        <span>Monday - Friday:</span>
                        <span>8:00 AM - 5:00 PM</span>
                    </div>
                    <div class="d-flex justify-content-between mb-1">
                        <span>Saturday:</span>
                        <span>9:00 AM - 1:00 PM</span>
                    </div>
                    <div class="d-flex justify-content-between mb-1">
                        <span>Sunday:</span>
                        <span>Closed</span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6 class="text-primary mb-2">Response Time</h6>
                    <ul class="list-unstyled text-muted small mb-0">
                        <li><i class="fas fa-clock text-info me-2"></i>Urgent: Within 2 hours</li>
                        <li><i class="fas fa-clock text-warning me-2"></i>High: Within 24 hours</li>
                        <li><i class="fas fa-clock text-success me-2"></i>Normal: Within 48 hours</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-question-circle me-2"></i>Common Issues</h5>
            </div>
            <div class="card-body">
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="faq1">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1">
                                How do I make a loan payment?
                            </button>
                        </h2>
                        <div id="collapse1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Go to "My Loans" → Select your loan → Click "Make Payment" → Enter amount and details → Submit.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="faq2">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2">
                                What documents do I need for a loan?
                            </button>
                        </h2>
                        <div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Valid ID, salary slip, bank statement, and guarantor information are required.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="faq3">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3">
                                How long does loan approval take?
                            </button>
                        </h2>
                        <div id="collapse3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Typically 5-10 business days from application submission to final approval.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Before Contacting</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled text-muted small mb-0">
                    <li><i class="fas fa-check text-success me-2"></i>Check our FAQ section first</li>
                    <li><i class="fas fa-check text-success me-2"></i>Have your loan ID ready</li>
                    <li><i class="fas fa-check text-success me-2"></i>Include relevant screenshots</li>
                    <li><i class="fas fa-check text-success me-2"></i>Be specific about your issue</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Auto-resize textarea
    const messageTextarea = document.getElementById('{{ form.message.id_for_label }}');
    if (messageTextarea) {
        messageTextarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });
    }
});
</script>
{% endblock %}





